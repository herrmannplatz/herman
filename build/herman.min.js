/*! herman 2013-12-20 */
window.herman=window.herman||{},function(){}(window.herman),window.herman=window.herman||{},function(a){var b=Math.PI/180,c=15;a.Matrix=function(){this.a11=1,this.a12=0,this.a13=0,this.a21=0,this.a22=1,this.a23=0,this.a31=0,this.a32=0,this.a33=1},a.Matrix.prototype={translate:function(a,b){return this.a13+=a,this.a23+=b,this},rotate:function(a){a*=b;var d=Math.sin(a).toFixed(c),e=Math.cos(a).toFixed(c),f=this.a11,g=this.a21;return this.a11=e*f+d*this.a12,this.a12=-d*f+e*this.a12,this.a21=e*g+d*this.a22,this.a22=-d*g+e*this.a22,this},scale:function(a){return this.a11*=a,this.a12*=a,this.a21*=a,this.a22*=a,this},scaleNonUniform:function(){return this},transform:function(a,b,c,d){return this.translate(a,b).rotate(c).scale(d)},multiply:function(a){var b=this.a11,c=this.a12,d=this.a13,e=this.a21,f=this.a22,g=this.a23,h=this.a31,i=this.a32,j=this.a33;return this.a11=b*a.a11+c*a.a21+d*a.a31,this.a12=b*a.a12+c*a.a22+d*a.a32,this.a13=b*a.a13+c*a.a23+d*a.a33,this.a21=e*a.a11+f*a.a21+g*a.a31,this.a22=e*a.a12+f*a.a22+g*a.a32,this.a23=e*a.a13+f*a.a23+g*a.a33,this.a31=h*a.a11+i*a.a21+j*a.a31,this.a32=h*a.a12+i*a.a22+j*a.a32,this.a33=h*a.a13+i*a.a23+j*a.a33,this},log:function(){return this.a11+" "+this.a12+" "+this.a13+"\n"+this.a21+" "+this.a22+" "+this.a23+"\n"+this.a31+" "+this.a32+" "+this.a33+"\n"}}}(window.herman),window.herman=window.herman||{},function(a){function b(){this.tag=null,this.parent=null,this.children=[],this.matrix=new a.Matrix,this.x=0,this.y=0,this.scale=1,this.rotation=0}a.Node=b;var c=b.prototype;c.getMatrix=function(){return this.matrix=(new a.Matrix).transform(this.x,this.y,this.rotation,this.scale),this.parent&&(this.matrix=this.parent.getMatrix().multiply(this.matrix)),this.matrix},c.position=function(a,b){this.x=a,this.y=b},c.rotate=function(a){this.rotation=a},c.setScale=function(a){this.scale=a},c.addChild=function(a){this.addChildAt(a,this.children.length)},c.addChildAt=function(a,c){return 0>c||c>this.children.length?(console.log("index out of bounds"),void 0):(a instanceof b&&!this.hasChild(a)&&(a.parent&&a.parent.removeChild(a),this.children.splice(c,0,a),a.parent=this),void 0)},c.removeChild=function(a){a instanceof b&&this.hasChild(a)&&this.removeChildAt(this.children.indexOf(a))},c.removeChildAt=function(a){return 0>a||a>=this.children.length?(console.log("index out of bounds"),void 0):(this.children[a].parent=null,this.children.splice(a,1),void 0)},c.hasChild=function(a){return-1!==this.children.indexOf(a)},c.getChildren=function(){return this.children},c.getChild=function(a){var b=this.children.indexOf(a);return-1!==b?this.children[b]:void 0},c.getChildAt=function(a){return 0>a||a>=this.children.length?(console.log("index out of bounds"),void 0):this.children[a]}}(window.herman),window.herman=window.herman||{},function(a){function b(b){a.Node.call(this),this.element=b||$("<div/>")}a.DomNode=b;var c=a.Node.prototype,d=b.prototype=new a.Node;d.update=function(){var a=this.getMatrix();this.element.css({transform:"matrix("+a.a11+","+a.a21+","+a.a12+","+a.a22+","+a.a13+","+a.a23+")"}),this.children.forEach(function(a){a.update()})},d.position=function(){c.position.apply(this,arguments),this.parent&&this.update()},d.rotate=function(){c.rotate.apply(this,arguments),this.parent&&this.update()},d.setScale=function(){c.setScale.apply(this,arguments),this.parent&&this.update()},d.addChild=function(a){c.addChild.apply(this,arguments),a.update(),$(".dom.stage").append(a.element)},d.removeChild=function(a){c.addChild.apply(this,arguments),a.element.remove()}}(window.herman),window.herman=window.herman||{},function(a){function b(a){c.call(this),this.context=a.getContext("2d")}var c=a.Node;a.CanvasNode=b;var d=c.prototype,e=b.prototype=new c;e.draw=function(){var a=this.getMatrix();this.context.save(),this.context.setTransform(a.a11,a.a21,a.a12,a.a22,a.a13,a.a23),this.context.fillStyle="rgb(200,0,0)",this.context.fillRect(10,10,55,50),this.context.restore()},e.update=function(){this.draw(),this.children.forEach(function(a){a.update()})},e.position=function(){d.position.apply(this,arguments),this.parent&&this.update()},e.rotate=function(){d.rotate.apply(this,arguments),this.parent&&this.update()},e.setScale=function(){d.setScale.apply(this,arguments),this.parent&&this.update()},e.addChild=function(a){d.addChild.apply(this,arguments),a.update()}}(window.herman);